---
import "../styles/global.css";
import AppFooter from "../components/navigation/AppFooter.astro";
import AppNavbar from "../components/navigation/AppNavbar.astro";
import { ToastProvider } from "../components/ui/ToastProvider";

interface Props {
  title?: string;
}

const { title = "10x Astro Starter" } = Astro.props;
const currentPath = Astro.url.pathname;
const userEmail = Astro.locals.user?.email ?? undefined;
// Keep navigation free in focus-heavy flows (/study, /auth). Update this list when new distraction-free routes are added.
const hideNavigation = currentPath.startsWith("/study") || currentPath.startsWith("/auth");
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
  </head>
  <body class="bg-background text-foreground antialiased">
    <a
      href="#main-content"
      class="skip-link fixed left-4 top-4 z-50 -translate-y-24 rounded-full bg-primary px-4 py-2 text-sm font-semibold text-primary-foreground transition focus-visible:translate-y-0 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary/70"
    >
      Pomiń do treści głównej
    </a>
    {!hideNavigation && <AppNavbar currentPath={currentPath} userEmail={userEmail} />}
    <div id="main-content" tabindex="-1" class="min-h-[70vh]">
      <slot />
    </div>
    <AppFooter />
    <ToastProvider client:load />
  </body>
</html>

<style>
  html,
  body {
    margin: 0;
    width: 100%;
    height: 100%;
    background-color: transparent;
  }
</style>
